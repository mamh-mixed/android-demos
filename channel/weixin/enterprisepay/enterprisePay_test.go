package enterprisepay

import (
	"testing"

	"github.com/CardInfoLink/quickpay/model"
	"github.com/CardInfoLink/quickpay/util"
)

var clientCert = []byte(`-----BEGIN CERTIFICATE-----
MIIEaDCCA9GgAwIBAgIDAYRnMA0GCSqGSIb3DQEBBQUAMIGKMQswCQYDVQQGEwJD
TjESMBAGA1UECBMJR3Vhbmdkb25nMREwDwYDVQQHEwhTaGVuemhlbjEQMA4GA1UE
ChMHVGVuY2VudDEMMAoGA1UECxMDV1hHMRMwEQYDVQQDEwpNbXBheW1jaENBMR8w
HQYJKoZIhvcNAQkBFhBtbXBheW1jaEB0ZW5jZW50MB4XDTE1MDIxMDA5NTIwNVoX
DTI1MDIwNzA5NTIwNVowgZgxCzAJBgNVBAYTAkNOMRIwEAYDVQQIEwlHdWFuZ2Rv
bmcxETAPBgNVBAcTCFNoZW56aGVuMRAwDgYDVQQKEwdUZW5jZW50MQ4wDAYDVQQL
EwVNTVBheTEtMCsGA1UEAxQk5LiK5rW36K6v6IGU5pWw5o2u5pyN5Yqh5pyJ6ZmQ
5YWs5Y+4MREwDwYDVQQEEwgxMDA4Njc2NjCCASIwDQYJKoZIhvcNAQEBBQADggEP
ADCCAQoCggEBALJAQYqloHovS+fh8+jVDfHrGqgB3Qb+gTM/E8Q0aSikyXvIAON5
9Nie1EY4nPrXf+soJigImUjeFb9jExA4pnky7s0h24RXPlTJKO4t7+qpS3IGK9Is
3UFDF19IVqqjFFVodY2ZXyyyL4wUJcHWiIuNF5YaEv7lAvXFQI45xAMD5a5H/+js
FEcvNVz8HcbH5mB5+f4igCZW9LQh17/LEmg9zcoSRNIeVeWf69hDs5u3//ntjA7u
TZXWVxj8A4tpB6i0VnX0GMW9FABBWiLZNpYxeEtdPoculmpjwxYErpEaFBuSJdlM
aXHcVNtsx04S/HxBP4x2yFhMY4ZOPScRJvcCAwEAAaOCAUYwggFCMAkGA1UdEwQC
MAAwLAYJYIZIAYb4QgENBB8WHSJDRVMtQ0EgR2VuZXJhdGUgQ2VydGlmaWNhdGUi
MB0GA1UdDgQWBBTz34uDT3mCAXESdt6AQzTpfCeyqTCBvwYDVR0jBIG3MIG0gBQ+
BSb2ImK0FVuIzWR+sNRip+WGdKGBkKSBjTCBijELMAkGA1UEBhMCQ04xEjAQBgNV
BAgTCUd1YW5nZG9uZzERMA8GA1UEBxMIU2hlbnpoZW4xEDAOBgNVBAoTB1RlbmNl
bnQxDDAKBgNVBAsTA1dYRzETMBEGA1UEAxMKTW1wYXltY2hDQTEfMB0GCSqGSIb3
DQEJARYQbW1wYXltY2hAdGVuY2VudIIJALtUlyu8AOhXMA4GA1UdDwEB/wQEAwIG
wDAWBgNVHSUBAf8EDDAKBggrBgEFBQcDAjANBgkqhkiG9w0BAQUFAAOBgQCf9iA5
tcB/DqOTdugbAHL47WZNem+9lZnhUL1bppmOnqeKu7uslg1OLNm5KKRFXWX1s2aK
SMYkeEvTrW7dtF82deP7fQ1DM3KqTIrizFsvIKxHdiIhZk1wv/MgQURWTw8Q0ILV
2OPKal8lbrkhHcAmThB8994mVzgSvwfVgADU9g==
-----END CERTIFICATE-----
`)
var clientKey = []byte(`-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAskBBiqWgei9L5+Hz6NUN8esaqAHdBv6BMz8TxDRpKKTJe8gA
43n02J7URjic+td/6ygmKAiZSN4Vv2MTEDimeTLuzSHbhFc+VMko7i3v6qlLcgYr
0izdQUMXX0hWqqMUVWh1jZlfLLIvjBQlwdaIi40XlhoS/uUC9cVAjjnEAwPlrkf/
6OwURy81XPwdxsfmYHn5/iKAJlb0tCHXv8sSaD3NyhJE0h5V5Z/r2EOzm7f/+e2M
Du5NldZXGPwDi2kHqLRWdfQYxb0UAEFaItk2ljF4S10+hy6WamPDFgSukRoUG5Il
2UxpcdxU22zHThL8fEE/jHbIWExjhk49JxEm9wIDAQABAoIBAHTfQJoBgrjaLfC5
68yrdNs7hVzG6/7b/CZ3oyQwIQrvENRCDKMZoXoumYv5LqQhi9PJnUr+aFKomqXD
9gnauvwYcw64tk+NTGcXBek04WuA2ODIPw8tL1zM+pQUwA5dosVlGj5fY1HQ+u/j
feYcHacyOVbHfdD2ovw1+t/F7Ej0uoWx0uRZRHk4fkdw/JxiOt5ZFNVVy+YLL2Na
AADZ3uaHuSNMyrr99qIHo6jlSwCz/Eg4fKpaWmM1BTm9c5xXC1pKZvQLs9FU0Xcs
9qRjl9hTOHH8lgHl+MMago4GHt8230dRmkt7gHrgW2WUYv38KHCaCUayE9FnRFBo
xWiVE9ECgYEA42KrDJ5XZQ5j0+e18Bbs5Vvg+SzHq/aBEHOThxK56kzPs75wGP+J
nAaH0RUENQQXKdaKDWEn/BrbDuWcgox6+9Q4jYyD4RKbDZmOS4prMx/OTP6nQX0c
jV4Agec0gHtM1mIitKvmHHjy6MPSJyD9x19sN/z8HjgaNcfdJzl3NBsCgYEAyK6y
1dLkCQ9rNyKoa3KYDnFrmVGwzV9MsMBHkOT2X2E55BMzOk0KzAGuwFuyz7ASku9N
Zgt+iUIsSXulrUlD9RBY7+ViHFYI81Mn4zQsT6xSUPsDdjDtJES3MyrUWFQuBqyx
T+dEdiMrnCu34uAsucjr/bPAzoq/e9m+wCdgLlUCgYBenmU9B/qn85f4yre7o16K
hnQUW9zuotHMDbv6/gDdDX90dS9iR5t0kIcdqtgoU35sC3lA3gfscSRsi4FYFarr
dcDerfUGyF47B4Xdy0iWaorHIURqDOy/qrkdVR9Uw3oSz51PfyRu/qld0HZ3j9Pq
jbuThLNIw+GsNXHCa7g9twKBgQCe6K8V4CvP/NSiUSBaDODZNvjD7Er7JQZ+Q5On
6ZYpyrxjnMyI0u7EwmRVT4dVLBBZJ4L7Vgi5uZuGCJIVmJlmWa6DL/kzhPELdIJ2
SB76a/K2yz1ffriZaoxCyRxiYS4c/Oxe4Dt27LygqoGu9mKULsSoHYmEQ5wC/1Yr
pEJmDQKBgQCQYrzCabObH3Yx0N2Uxc/rqcIXqPuW5lR6BHZkN8EzLzykxX068zfL
rwERwybTKRoGin2PuStBdbibuXt0sf8JrTCBkFPzJI/BL15ORnbG/rYe35gQrNhd
6ePbNPU4+UhogBJ6dq+fRrFUGGwuW2GIbKwea78ptA+Lq1C+siAqpg==
-----END RSA PRIVATE KEY-----
`)

func TestEnterprisePay(t *testing.T) {

	req := &model.ScanPayRequest{}
	req.ActTxamt = "100"
	req.AppID = "wxaa785395d3d09403"
	req.ChanMerId = "1228767002"
	req.CheckName = "NO_CHECK"
	req.Desc = "ipad mini 16G"
	req.OpenId = "omYJssw14onUqv2tocdt0EID3dIc"
	req.OrderNum = util.Millisecond()
	req.SignKey = "dskskfasfsdsjdjqisi343sd99f9djfj"

	req.WeixinClientCert = clientCert
	req.WeixinClientKey = clientKey

	DefaultClient.ProcessPay(req)

}
