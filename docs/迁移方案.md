罗强给出了迁移方案，大致分为四步，依次对应与扫码网关直接对接的四类组件（或系统），每一步首先在测试环境预演。


迁移前，先同步数据，主要包括商户数据、证书、交易数据（陈芝锐负责）。

迁移顺序如下：Windows 插件（DLL）、直接 API 对接的系统、JSSDK、移动 SDK（麻烦罗强）。

本周之后新入网的商户，无需再迁移，在新系统上直接配置入网（王诗景负责，以后转交给运营）。


系统发布、与个组件（系统）对接、调试、监控，我负责。

麻烦各位提前做好准备，写好脚本、备好材料、熟悉操作流程，以免相互等待拖延进度。


--------------------

以下是罗强给的详细迁移方案

没做过迁移方案，以下是我想到的内容，然后我还会做一个操作表，相关工作的顺序及完成情况。是这样的东西吗？
1，云收银新系统测试即将完成，完成上线工作后即开展迁移工作，原则是在确保交易正常、稳定的情况下，逐步迁移到新系统，分批迁移，持续观察。
2，新系统首先考虑迁移使用桌面版，Windows插件的客户，观察一段时间稳定后，切换线下联机系统交易至新平台。
3，网页版及jssdk接入在jssdk对接完新接口后，测试通过后切入，预计下周开发完成，测试待定。
4，移动版app的切换会更晚，部分接口还未开发，同时移动版app也要改造并测试。
5，API接入的客户切换工作需要客户修改参数进行配置，新系统交易稳定后，通知并安排客户在一定时间内逐个切入新系统

注意：
1，迁移工作按测试环境先做一遍，一是为了保留测试数据，方便接入测试的客户无缝切换；二是对生产环境迁移工作做一次预演，确保生产迁移工作的顺利，测试环境迁移过程中遇到的问题及解决方案做好详细记录。
2，首先要完成数据的迁移：包括商户数据，微信证书，还有交易数据等


支持部门及客户侧工作：
1，对于使用云收银桌面版的客户，给客户提供新的IP和端口地址，客户名单：家兴，格格屋，好彩（其他客户跟市场部门确认）
2，对于使用Windows插件的客户，给客户提供新的IP和端口地址，客户名单：云智汇，舟山(其他客户更市场部门确认)
3，对于使用app的客户，提醒用户更新app并提示切换当日先升级app再做交易，否则当日数据可能不准确
4，对于API直接接入的客户，提供新的IP和端口，并且配合做一次生产验收，确保各交易类型对方系统处理正常。（华夏鑫彩、盛本等）


新老系统批量切换
--------------
具体方案是，在老系统上安装一个代理（nginx/haproxy），把所有TCP 请求代理到新系统上。

需要我们把应答码暂时改成英文。

先在测试环境 211.147.72.70 上试验一遍，如果可行，而且比较稳定，确定一个时间，生产上切换，所有人都参与测试验证。
