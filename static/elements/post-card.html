<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-shadow/paper-shadow.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/core-icon/core-icon.html">
<link rel="import" href="../bower_components/core-icon-button/core-icon-button.html">
<polymer-element name="post-card">
    <template>
        <style>
            :host {
                display: block;
                position: relative;
                width: 100%;
            }
            .container{
                margin-bottom:20px;
            }

            .content {
                padding: 24px 16px 16px;
            }

            .action {
                padding: 8px;
            }

            .action > .read-more-btn,
            .action > .close-more-btn {
                float: right;
            }

            .detail{
                padding: 16px 16px 24px;
            }
            paper-button.choose-btn {
                color: #4285f4;
            }
        </style>
        <core-ajax id="routerAjax" url="/quickMaster/router/find" handleAs="json" on-core-response="{{onRouterAjaxResponse}}"></core-ajax>
        <paper-shadow z="1">
            <div class="container">
                <div class="content">
                    <content></content>
                </div>
                <div class="action">
                    <paper-button toggle class="choose-btn" on-tap="{{chosenTapped}}">
                        <core-icon icon="check"></core-icon>
                        选择该商户
                    </paper-button>
                    <core-icon-button class="read-more-btn" icon="expand-more" hidden?={{isReadMore}} on-tap="{{expandMore}}"></core-icon-button>
                    <core-icon-button class="close-more-btn" icon="expand-less" hidden?={{!isReadMore}} on-tap="{{expandLess}}"></core-icon-button>
                </div>
                <div class="detail" hidden?={{!isReadMore}}>
                    <table>
                        <thead>
                            <tr>
                                <th>卡品牌</th>
                                <th>渠道代码</th>
                                <th>渠道商户号</th>
                            </tr>
                        </thead>
                        <tbody>
                            <template repeat="{{route in routers}}">
                                <tr>
                                    <td>{{route.cardBrand}}</td>
                                    <td>{{route.chanCode}}</td>
                                    <td>{{route.chanMerId}}</td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>
        </paper-shadow>
    </template>
    <script>
        Polymer({
            publish: {
                isReadMore: {
                    value: false,
                    reflect: true
                }
            },
            chosenTapped: function(event, detail, sender) {
                console.log("choose");
                this.fire('chosen-tap');
            },
            // 展开查看更多信息
            expandMore: function(e, d, s) {
                // 到后台加载更多信息
                var ajax = this.$.routerAjax;
                // ajax.params = '{"merId":}'
                // ajax.go();
                this.isReadMore = true;
            },
            // 收起更多信息
            expandLess: function(e, d, s) {
                this.isReadMore = false;
            },
            chooseMerchant: function(e,d,s){

            },
            // 查找路由信息
            onRouterAjaxResponse: function() {
                var response = this.$.ajax.response;
                if (response.status === 0) {
                    this.routers = response.data.slice(0)
                }
            }


        });
    </script>
</polymer-element>
