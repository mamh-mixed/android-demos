<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">

<dom-module id="merchant-view">

  <style>
    :host {
      display: block;
      --paper-checkbox-label-spacing: 4px;
      --paper-dialog-scrollable: {
        font-size: 14px;
        width: 700px;
        height: 500px;
      }
    }

    paper-checkbox {
      display: inline-block;
    }

    #dialogView {
      background-color: #ffffff;
    }

    .key {
      font-weight: bold;
      text-align: left !important;
    }

    .table .th {
      display: table-cell;
      max-width: 60px;
    }

    .table .td {
      display: table-cell;
    }

    paper-tabs,
    paper-toolbar {
      background-color: #00bcd4;
      color: #fff;
      box-shadow: 0px 3px 6px rgba(0, 0, 0, 0.2);
    }

    paper-toolbar paper-tabs {
      box-shadow: none;
    }

    paper-tabs[noink][no-bar] paper-tab.iron-selected {
      color: #ffff8d;
    }

    paper-tabs[align-bottom] {
      box-shadow: 0px -2px 6px rgba(0, 0, 0, 0.15);
    }

    dt {
      display: inline-block;
      float: left;
      clear: both;
      width: 140px;
      font-weight: bold;
    }

    dd {
      display: inline-block;
      float: left;
      margin-left: 24px;
    }

    dd.cert {
      float: none;
      display: block;
      margin-left: 10px;
      clear: both;
    }

    paper-tabs {
      margin-top: 0;
    }

    .checkbox-group > paper-checkbox {
      margin-right: 20px;
    }
  </style>
  <template>
    <paper-dialog with-backdrop id="dialogView">
      <paper-tabs selected="{{idx}}">
        <paper-tab>
          <i18n-msg msgid="MERCHANT_INPUT.TAB_MERCHANT_INFO">门店信息</i18n-msg>
        </paper-tab>
        <paper-tab>
          <i18n-msg msgid="MERCHANT_INPUT.TAB_ALIPAY">支付宝</i18n-msg>
        </paper-tab>
        <paper-tab>
          <i18n-msg msgid="MERCHANT_INPUT.TAB_WXP">微信</i18n-msg>
        </paper-tab>
        <!-- <paper-tab>
          <i18n-msg msgid="MERCHANT_INPUT.TAB_ULIVE">优方</i18n-msg>
        </paper-tab> -->
      </paper-tabs>
      <paper-dialog-scrollable>
        <iron-pages selected="{{idx}}">
          <section alias="merchant">
            <div class="table low">
              <div class="tbody">
                <div class="tr">
                  <div class="th key">
                    <i18n-msg msgid="SCANPAY_TRADE_LIST.MERCHANT_NO">门店代码</i18n-msg>
                  </div>
                  <div class="td">{{item.merId}}</div>
                  <div class="th key">
                    <i18n-msg msgid="SCANPAY_TRADE_LIST.MERCHANT_NAME">门店名称</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.merName}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="TRADE_DETAIL.AGENT_NO">代理代码</i18n-msg>
                  </div>
                  <div class="td">{{item.agentCode}}</div>
                  <div class="td key">
                    <i18n-msg msgid="SCANPAY_TRADE_STATS.AGENT_NAME">代理名称</i18n-msg>
                  </div>
                  <div class="td">{{item.agentName}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="SCANPAY_TRADE_LIST.SUBAGENT_NO">公司代码</i18n-msg>
                  </div>
                  <div class="td">{{item.subAgentCode}}</div>
                  <div class="td key">
                    <i18n-msg msgid="TRADE_DETAIL.GROUP_NAME">公司名称</i18n-msg>
                  </div>
                  <div class="td">{{item.subAgentName}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="SCANPAY_TRADE_LIST.GROUP_NO">商户代码</i18n-msg>
                  </div>
                  <div class="td">{{item.groupCode}}</div>
                  <div class="td key">
                    <i18n-msg msgid="SCANPAY_TRADE_STATS.GROUP_NAME">商户名称</i18n-msg>
                  </div>
                  <div class="td">{{item.groupName}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.SIGN_CHECK">开启验签</i18n-msg>
                  </div>
                  <div class="td">
                    <paper-checkbox checked$="{{item.isNeedSign}}" disabled></paper-checkbox>
                  </div>
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.SIGNKEY">签名密钥</i18n-msg>
                  </div>
                  <div class="td" colspan="3" style="word-break:break-all;">{{item.signKey}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.ACCTNAME">开户姓名</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.acctName}}</div>
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.ACCTNUM">开户账户</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.acctNum}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.OPENBANKNAME">支行名称</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.openBankName}}</div>
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.BANKNAME">开户行名称</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.bankName}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.TRANSCURR">交易币种</i18n-msg>
                  </div>
                  <div class="td">{{item.transCurr}}</div>
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.BANKID">开户行号</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.bankId}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.PROVINCE">省份</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.province}}</div>
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.CITY">城市</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.city}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.SHOPTYPE">门店类型</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.shopType}}</div>
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.SHOPID">门店 ID</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.shopID}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.GOODSTAG">商品标签</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.goodsTag}}</div>
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.COMMODITYNAME">商品名称</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.commodityName}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.BRANDNUM">品牌编号</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.brandNum}}</div>
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.REMARK">备注</i18n-msg>
                  </div>
                  <div class="td" style="word-break:break-all;">{{item.remark}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.TITLEONE">标题一</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.titleOne}}</div>
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.TITLETWO">标题二</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.titleTwo}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.SUCC_BTN_TXT">成功跳转文本</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.succBtnTxt}}</div>
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.SUCC_BTN_TXT">成功跳转连接</i18n-msg>
                  </div>
                  <div class="td">{{item.detail.SUCC_BTN_LINK}}</div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.ISPOSTAMOUNT">是否传送金额</i18n-msg>
                  </div>
                  <div class="td">
                    <paper-checkbox checked$="{{item.detail.isPostAmount}}" disabled></paper-checkbox>
                  </div>
                </div>
                <div class="tr">
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.MER_STATUS">门店状态</i18n-msg>
                  </div>
                  <div class="td">{{getMerStatus(item.merStatus)}}</div>
                  <div class="td key">
                    <i18n-msg msgid="MERCHANT.UNIQUEID">唯一码</i18n-msg>
                  </div>
                  <div class="td">{{item.uniqueId}}</div>
                </div>
                <div class="tr">
                  <div class="th key">
                    <i18n-msg msgid="TRADE_DETAIL.CREATE_TIME">创建时间</i18n-msg>
                  </div>
                  <div class="td">{{item.createTime}}</div>
                  <div class="th key">
                    <i18n-msg msgid="TRADE_DETAIL.MODIFY_TIME">更新时间</i18n-msg>
                  </div>
                  <div class="td">{{item.updateTime}}</div>
                </div>
              </div>
            </div>
            <dl>
              <dt class="key">
                <i18n-msg msgid="MERCHANT.BILL_URL">账单URL</i18n-msg>
              </dt>
              <dd>{{item.detail.billUrl}}</dd>
              <dt class="key">
                <i18n-msg msgid="MERCHANT.PAY_URL">支付URL</i18n-msg>
              </dt>
              <dd>{{item.detail.payUrl}}</dd>
              <dt class="key">
                <i18n-msg msgid="MERCHANT.PERMISSION_GROUP">授权接口</i18n-msg>
              </dt>
              <dd class="checkbox-group">
                <template id="permissionRepeatDom" is="dom-repeat" items="{{permissionArray}}" as="perm">
                  <paper-checkbox checked$="{{perm.isChecked}}" disabled>
                    <span>
                      <i18n-msg msgid$="{{getPermission(perm.key)}}">{{perm.value}}</i18n-msg>
                    </span>
                  </paper-checkbox>
                </template>
              </dd>
            </dl>
          </section>
          <section alias="alipay">
            <paper-dialog-scrollable>
              <dl id="alp">
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.CHAN_CODE">渠道代码</i18n-msg>:
                </dt>
                <dd>{{alipay.chanCode}}</dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.CHAN_MER_ID">商户代码</i18n-msg>:
                </dt>
                <dd>{{alipay.chanMerId}}</dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.CHAN_MER_NAME">商户名称</i18n-msg>:
                </dt>
                <dd>{{alipay.chanMerName}}</dd>
                <dt>MD5 KEY:</dt>
                <dd>{{alipay.signCert}}</dd>
                <dt>
                  <i18n-msg msgid="TRADE_DETAIL.AGENT_NO">代理代码</i18n-msg>:
                </dt>
                <dd>{{alipay.agentCode}}</dd>
              </dl>
            </paper-dialog-scrollable>
          </section>
          <section alias="weixin">
            <paper-dialog-scrollable>
              <dl id="wxp">
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.CHAN_CODE">渠道代码</i18n-msg>:
                </dt>
                <dd>{{weixin.chanCode}}</dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.CHAN_MER_ID">商户代码</i18n-msg>:
                </dt>
                <dd>{{weixin.chanMerId}}</dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.CHAN_MER_NAME">商户名称</i18n-msg>:
                </dt>
                <dd>{{weixin.chanMerName}}</dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.IS_AGENT_MODE">是否代理商模式</i18n-msg>:
                </dt>
                <dd>
                  <paper-checkbox checked$="{{weixin.isAgentMode}}" disabled></paper-checkbox>
                </dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.BIG_MERCHANT">大商户号</i18n-msg>:
                </dt>
                <dd>{{weixin.agentMer.chanMerId}}</dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.WXP_APP_ID">微信 APPID</i18n-msg>:
                </dt>
                <dd>{{weixin.wxpAppId}}</dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.SIGN_CERT_WXP">签名密钥</i18n-msg>:
                </dt>
                <dd>{{weixin.signCert}}</dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.HTTP_CERT">HTTP 证书</i18n-msg>:
                </dt>
                <dd class="cert">
                  <pre>{{weixin.httpCert}}</pre>
                </dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.HTTP_KEY">HTTP 密钥</i18n-msg>:
                </dt>
                <dd class="cert">
                  <pre>{{weixin.httpKey}}</pre>
                </dd>
              </dl>
            </paper-dialog-scrollable>
          </section>
          <!-- <section alias="ulive">
            <paper-dialog-scrollable>
              <dl id="ulive">
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.CHAN_CODE">渠道代码</i18n-msg>:
                </dt>
                <dd>{{ulive.chanCode}}</dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.CHAN_MER_ID">商户代码</i18n-msg>:
                </dt>
                <dd>{{ulive.chanMerId}}</dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.CHAN_MER_NAME">商户名称</i18n-msg>:
                </dt>
                <dd>{{ulive.chanMerName}}</dd>
                <dt>
                  <i18n-msg msgid="CHAN_MERCHANT.TERMINAL_ID">终端号</i18n-msg>:
                </dt>
                <dd>{{ulive.terminalId}}</dd>
              </dl>
            </paper-dialog-scrollable>
          </section> -->
      </paper-dialog-scrollable>
      <div class="buttons layout center">
        <label hidden$="{{!deleteFlag}}" style="color:#FF0000;">
          <i18n-msg msgid="CHAN_MERCHANT.TERMINAL_ID">您确定要删除这个门店吗?</i18n-msg>
        </label>
        <paper-button hidden$="{{!deleteFlag}}" on-tap="cancelDeleteTap">
          <i18n-msg msgid="BUTTON.CANCEL">取消</i18n-msg>
        </paper-button>
        <paper-button hidden$="{{!deleteFlag}}" on-tap="confirmDeleteTap">
          <i18n-msg msgid="BUTTON.CONFIRM">确认</i18n-msg>
        </paper-button>
        <paper-button hidden$="{{deleteFlag}}" on-tap="deleteTap">
          <i18n-msg msgid="BUTTON.DELETE">删除</i18n-msg>
        </paper-button>
        <paper-button hidden$="{{deleteFlag}}" on-tap="handleItemEditedEvent">
          <i18n-msg msgid="BUTTON.EDITOR">编辑</i18n-msg>
        </paper-button>
        <paper-button hidden$="{{deleteFlag}}" on-tap="handleViewRouteTapped">
          <i18n-msg msgid="BUTTON.VIEW_ROUTE">查看路由</i18n-msg>
        </paper-button>
        <paper-button hidden$="{{deleteFlag}}" on-tap="handleClose">
          <i18n-msg msgid="BUTTON.CLOSE">关闭</i18n-msg>
        </paper-button>
      </div>
    </paper-dialog>
    <x-ajax id="deleteMerAjax" method="POST" url="/master/merchant/delete" handle-as="json" on-response="handleDeleteResponse"></x-ajax>
    <x-ajax id="queryMerchantAjax" method="GET" url="/master/merchant/one" handle-as="json" debounce-duration="1000" on-response="handleQueryMerchantResponse"></x-ajax>
    <x-ajax id="alpChanMerAjax" method="GET" url="/master/channelMerchant/findByMerIdAndCardBrand" handle-as="json" debounce-duration="1000" on-response="handleAlpChanMerResponse"></x-ajax>
    <x-ajax id="wxpChanMerAjax" method="GET" url="/master/channelMerchant/findByMerIdAndCardBrand" handle-as="json" debounce-duration="1000" on-response="handleWxpChanMerResponse"></x-ajax>
    <x-ajax id="uliveChanMerAjax" method="GET" url="/master/channelMerchant/findByMerIdAndCardBrand" handle-as="json" debounce-duration="1000" on-response="handleUliveChanMerResponse"></x-ajax>
  </template>
  <script>
    Polymer({
      is: 'merchant-view',
      attached: function() {
        this.fire('rerender-i18n', {
          from: 'merchant-view'
        });
      },
      properties: {
        permissionArray: {
          type: Array,
          value: [{
            key: 'PURC',
            value: 'TRANS_TYPE.PURC'
          }, {
            key: 'PAUT',
            value: 'TRANS_TYPE.PAUT'
          }, {
            key: 'QYZF',
            value: 'TRANS_TYPE.QYZF'
          }, {
            key: 'JSZF',
            value: 'TRANS_TYPE.JSZF'
          }, {
            key: 'INQY',
            value: 'TRANS_TYPE.INQY'
          }, {
            key: 'VOID',
            value: 'TRANS_TYPE.VOID'
          }, {
            key: 'REFD',
            value: 'TRANS_TYPE.REFD'
          }, {
            key: 'CANC',
            value: 'TRANS_TYPE.CANC'
          }
        //   , {
        //     key: 'VERI',
        //     value: 'TRANS_TYPE.VERI'
        //   }, {
        //     key: 'CRVE',
        //     value: 'TRANS_TYPE.CRVE'
        //   }, {
        //     key: 'QUVE',
        //     value: 'TRANS_TYPE.QUVE'
        //   }, {
        //     key: 'CAVE',
        //     value: 'TRANS_TYPE.CAVE'
        //   }
      ]
        },
        item: Object,
        merId: String,
      },
      observers: [
        '_permissionChanged(item.permission)',
        '_idxChange(idx)'
      ],
      _permissionChanged: function(value) {
        this.deleteFlag = false;
        for (var k = 0; k < this.permissionArray.length; k++) {
          this.set('permissionArray.' + k + '.isChecked', false);
        }
        var permissions = value;
        // 遍历当前商户的权限列表，把它们映射到this.permissionArray上，然后在页面上展示
        if (permissions) {
          for (var i = 0, il = permissions.length; i < il; i++) {
            var p = permissions[i];
            for (var j = 0, jl = this.permissionArray.length; j < jl; j++) {
              var pa = this.permissionArray[j];
              if (pa.key === p) {
                this.set('permissionArray.' + j + '.isChecked', true);
                break;
              }
            }
          }
        }
      },
      _idxChange: function(idx) {
        if (idx === 1 && !this.alipay.chanMerId) {
          var alpParams = {
            merId: this.item.merId,
            cardBrand: 'ALP'
          };
          this.$.alpChanMerAjax.params = alpParams;
          this.$.alpChanMerAjax.generateRequest();
          return;
        }
        if (idx === 2 && !this.weixin.chanMerId) {
          var wxpParams = {
            merId: this.item.merId,
            cardBrand: 'WXP'
          };
          this.$.wxpChanMerAjax.params = wxpParams;
          this.$.wxpChanMerAjax.generateRequest();
          return;
        }
        if (idx === 3 && !this.ulive.chanMerId) {
          this.$.uliveChanMerAjax.params = {
            merId: this.item.merId,
            cardBrand: 'ULIVE'
          };
          this.$.uliveChanMerAjax.generateRequest();
          return;
        }

      },
      open: function() {
        this.$.dialogView.open();
        this.idx = 0;
        this.alipay = {};
        this.weixin = {};
        this.ulive = {};
        if (this.merId && this.merId !== '') {
          var params = {
            merId: this.merId
          };
          this.$.queryMerchantAjax.params = params;
          this.$.queryMerchantAjax.generateRequest();
        }
      },
      _computeYesOrNo: function(flag) {
        var i18nMsg = document.createElement('i18n-msg');
        if (flag) {
          return i18nMsg.getMsg('MERCHANT.YES');
        }
        return i18nMsg.getMsg('MERCHANT.NO');
      },
      // 关闭事件
      handleClose: function() {
        this.$.dialogView.close();
      },
      //   将商户状态转换为中文
      getMerStatus: function(status) {
        var i18nMsg = document.createElement('i18n-msg');
        if (status === 'Normal') {
          return i18nMsg.getMsg('MERCHANT.NORMAL');
        } else if (status === 'Test') {
          return i18nMsg.getMsg('MERCHANT.TEST');
        } else if (status === 'Deleted') {
          return i18nMsg.getMsg('MERCHANT.DELETED');
        } else {
          return status;
        }
      },
      // 编辑事件
      handleItemEditedEvent: function() {
        this.fire('editor');
      },
      // 删除事件
      deleteTap: function() {
        this.deleteFlag = true;
      },
      // 取消删除事件
      cancelDeleteTap: function() {
        this.deleteFlag = false;
      },
      // 查看路由
      handleViewRouteTapped: function() {
        document.querySelector('#appRouter').go('/config/route/' + this.item.merId);
      },
      // 确认删除
      confirmDeleteTap: function() {
        this.$.deleteMerAjax.params = {
          merId: this.item.merId
        };
        this.$.deleteMerAjax.generateRequest();
      },
      // 删除机构商户响应信息
      handleDeleteResponse: function(e) {
        var response = e.detail.response;
        if (response.status !== 0) {
          Util.toast('MERCHANT.'+response.message, 3000,true);
          return;
        }
        Util.toast('MERCHANT.'+response.message, 3000,true);
        this.$.dialogView.close();
        this.fire('delete-ok');
      },
      // 查询门店信息响应事件
      handleQueryMerchantResponse: function(e) {
        var response = e.detail.response;
        if (response.status !== 0) {
          Util.toast('MERCHANT_INPUT.SELECT_MERCHANT_ERROR', 3000, true);
          return;
        }

        var item = response.data;
        this.set('item', item);
        if (item.permission) {
          var permissions = item.permission;
          // 遍历当前商户的权限列表，把它们映射到this.permissionArray上，然后在页面上展示
          for (var i = 0, il = permissions.length; i < il; i++) {
            var p = permissions[i];
            for (var j = 0, jl = this.permissionArray.length; j < jl; j++) {
              var pa = this.permissionArray[j];
              if (pa.key === p) {
                this.set('permissionArray.' + j + '.isChecked', true);
                break;
              }
            }
          }
        } else {
          // 如果商户权限未定义的话，设置未空数组，防止保存的时候权限信息没有传到后台
          this.set('item.permission', []);
        }
      },
      // 查询支付宝渠道信息的响应事件
      handleAlpChanMerResponse: function(e) {
        var response = e.detail.response;
        if (response.status !== 0 || !response.data) {
          Util.toast('MERCHANT_INPUT.SELECT_ALP_ERROR', 3000, true);
          return;
        }

        this.set('alipay', response.data);
      },
      // 查询微信渠道信息的响应事件
      handleWxpChanMerResponse: function(e) {
        var response = e.detail.response;
        if (response.status !== 0 || !response.data) {
          Util.toast('MERCHANT_INPUT.SELECT_WXP_ERROR', 3000, true);
          this.set('weixin.httpCert', '');
          this.set('weixin.httpKey', '');
          return;
        }

        if (!response.data.httpCert) {
          response.data.httpCert = '';
        }
        if (!response.data.httpKey) {
          response.data.httpKey = '';
        }
        this.set('weixin', response.data);
      },
      // 查询优方渠道信息的响应事件
      handleUliveChanMerResponse: function(e) {
        var response = e.detail.response;
        if (response.status !== 0 || !response.data) {
           Util.toast('MERCHANT_INPUT.SELECT_ULIVE_ERROR', 3000, true);
          return;
        }

        this.set('ulive', response.data);
        this.set('ulive.chanCode', 'ULIVE');
      },
      getPermission: function(value) {
        return 'TRANS_TYPE.' + value;
      }
    });
  </script>
</dom-module>
