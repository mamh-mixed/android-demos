<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../trade-detail/trade-detail.html">
<dom-module id="coupon-view">
  <style>
    :host {
      display: block;
      --paper-dialog-scrollable: {
        width: 600px;
        height: 340px;
      }
    }

    .header {
      font-weight: bold;
      color: #05B0CF;
    }

    .order {
      margin-top: 10px;
    }

    paper-dialog-scrollable /deep/ #scrollable {
      min-height: auto;
    }
  </style>
  <template>
    <paper-dialog with-backdrop id="dialogView">
      <h2>交易明细</h2>
      <paper-dialog-scrollable>
        <!-- 订单明细 -->
        <div class="content">
          <div class="table data-grid low" id="orderDetail">
            <div class="tr">
              <div class="td key">门店代码:</div>
              <div class="td">{{item.merId}}</div>
              <div class="td key">门店名称:</div>
              <div class="td">{{item.merName}}</div>
            </div>
            <div class="tr">
              <div class="td key">商户代码:</div>
              <div class="td">{{item.groupCode}}</div>
              <div class="td key">商户名称:</div>
              <div class="td">{{item.groupName}}</div>
            </div>
            <div class="tr">
              <div class="td key">公司代码:</div>
              <div class="td">{{item.subAgentCode}}</div>
              <div class="td key">公司名称:</div>
              <div class="td">{{item.subAgentName}}</div>
            </div>
            <div class="tr">
              <div class="td key">代理代码:</div>
              <div class="td">{{item.agentCode}}</div>
              <div class="td key">代理名称:</div>
              <div class="td">{{item.agentName}}</div>
            </div>
            <div class="tr">
              <div class="td key">终端代码:</div>
              <div class="td">{{item.terminalid}}</div>
              <div class="td key">商户订单:</div>
              <div class="td">{{item.orderNum}}</div>
            </div>
            <div class="tr">
              <div class="td key">券名称:</div>
              <div class="td">{{item.prodname}}</div>
              <div class="td key">券明细:</div>
              <div class="td">{{item.cardInfo}}</div>
            </div>
            <div class="tr">
              <div class="td key">核销次数:</div>
              <div class="td">{{item.veriTime}}</div>
              <div class="td key">可用次数:</div>
              <div class="td">{{item.availCount}}</div>
            </div>
            <div class="tr">
              <div class="td key">主机授权码:</div>
              <div class="td">{{item.authcode}}</div>
              <div class="td key">券有效期:</div>
              <div class="td">{{item.expDate}}</div>
            </div>
            <div class="tr">
              <div class="td key">交易渠道:</div>
              <div class="td">{{chanFilter(item.chanCode)}}</div>
              <div class="td key">交易类型:</div>
              <div class="td">{{busicdFilter(item.busicd)}}</div>
            </div>
            <div class="tr">
              <div class="td key">渠道商户:</div>
              <div class="td">{{item.chanMerId}}</div>
              <div class="td key">渠道订单:</div>
              <div class="td">{{item.chanOrderNum}}</div>
            </div>
            <div class="tr">
              <div class="td key">应答码:</div>
              <div class="td">{{item.respcd}}</div>
              <div class="td key">核销状态:</div>
              <div class="td">{{writeoffStatusFilter(item.writeoffStatus)}}</div>
            </div>
            <div class="tr">
              <div class="td key">创建时间:</div>
              <div class="td">{{item.transTime}}</div>
              <div class="td key">修改时间:</div>
              <div class="td">{{item.updateTime}}</div>
            </div>
            <div class="tr">
              <div class="td key">关联订单:</div>
              <div class="td">{{item.origOrderNum}}</div>
            </div>
          </div>
      </paper-dialog-scrollable>
      <div class="buttons">
        <paper-button on-tap="handleClose">关闭</paper-button>
      </div>
    </paper-dialog>
  </template>
  <script>
    var TRANS_TYPE_MAP = {
      'VERI': '卡券核销',
    };
    Polymer({
      is: 'coupon-view',

      properties: {
        item: Object,
      },
      open: function() {
        this.$.dialogView.open();
      },
      // 关闭事件
      handleClose: function() {
        this.$.dialogView.close();
      },
      writeoffStatusFilter: function(status) {
        var map = {
          'ERROR': '失败',
          'SUCCESS': '成功',
        };
        return (status + '—' + map[status]);
      },
      busicdFilter: function(busicd) {
        return (busicd + '—' + TRANS_TYPE_MAP[busicd]) || busicd;
      },
      chanFilter: function(chanCode) {
        var map = {
          'ALP': '支付宝',
          'WXP': '微信',
          'ULIVE': '优方'
        };
        return (chanCode + '—' + map[chanCode]);
      },
    });
  </script>
</dom-module>
