<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="trade-view">
  <style>
    :host {
      display: block;
      --paper-dialog-scrollable: {
        width: 600px;
        min-height: 500px;
        max-height: 500px;
        font-size: 14px;
      }
    }

    td {
      min-width: 70px;
      vertical-align: top;
    }

    .key {
      width: 70px;
    }

    .divider {
      height: 15px;
    }
  </style>
  <template>
    <paper-dialog id="dialogView">
      <h2>交易明细</h2>
      <paper-dialog-scrollable>
        <table>
          <tr>
            <td class="key">商户代码:</td>
            <td>{{item.merId}}</td>
            <td class="key">商户名称:</td>
            <td>{{item.merName}}</td>
          </tr>
          <tr>
            <td class="key">代理代码:</td>
            <td>{{item.agentCode}}</td>
            <td class="key">代理名称:</td>
            <td>{{item.agentName}}</td>
          </tr>
          <tr>
            <td class="key">终端代码:</td>
            <td>{{item.terminalid}}</td>
            <td class="key">商户订单:</td>
            <td>{{item.orderNum}}</td>
          </tr>
          <tr>
            <td class="key">交易金额:</td>
            <td>{{_currencyFilter(item.transAmt)}}</td>
            <td class="key">商品明细:</td>
            <td>{{item.goodsInfo}}</td>
          </tr>
          <tr>
            <td class="key">交易币种:</td>
            <td>{{item.transCurr}}</td>
            <td class="key">交易类型:</td>
            <td>{{busicdFilter(item.busicd)}}</td>
          </tr>
          <tr>
            <td class="key">交易渠道:</td>
            <td>{{chanFilter(item.chanCode)}}</td>
            <td class="key">受理商:</td>
            <td></td>
          </tr>
          <tr>
            <td class="key">渠道商户:</td>
            <td>{{item.chanMerId}}</td>
            <td class="key">渠道订单:</td>
            <td>{{item.chanOrderNum}}</td>
          </tr>
          <tr>
            <td class="key">渠道折扣:</td>
            <td>{{item.chanDiscount}}</td>
            <td class="key">商户折扣:</td>
            <td>{{item.merDiscount}}</td>
          </tr>
          <tr>
            <td class="key">应答码:</td>
            <td>{{item.respcd}}</td>
            <td class="key">交易状态:</td>
            <td>{{transStatusFilter(item.transStatus)}}</td>
          </tr>
          <tr>
            <td class="key">创建时间:</td>
            <td>{{item.transTime}}</td>
            <td class="key">修改时间:</td>
            <td>{{item.updateTime}}</td>
          </tr>
          <tr>
            <td colspan="4" class="divider"></td>
          </tr>
          <tr>
            <td>请求报文:</td>
          </tr>
          <tr>
            <td colspan="4">
              <pre></pre>
            </td>
          </tr>
          <tr>
            <td>响应报文:</td>
          </tr>
          <tr>
            <td colspan="4">
              <pre></pre>
            </td>
          </tr>
          <tr>
            <td colspan="2">渠道请求报文:</td>
          </tr>
          <tr>
            <td colspan="4">
              <pre></pre>
            </td>
          </tr>
          <tr>
            <td colspan="2">渠道响应报文:</td>
          </tr>
          <tr>
            <td colspan="4">
              <pre></pre>
            </td>
          </tr>
        </table>
      </paper-dialog-scrollable>
      <div class="buttons">
        <paper-button dialog-dismiss style="margin-right:50px;">取消</paper-button>
      </div>
    </paper-dialog>

  </template>
  <script>
    var TRANS_TYPE_MAP = {
      'PURC': '下单支付',
      'PAUT': '预下单',
      'VOID': '撤销',
      'REFD': '退款',
      'VERI': '卡券核销',
      'CANC': '取消',
      'purc': '下单支付',
      'paut': '预下单',
      'void': '撤销',
      'refd': '退款',
      'veri': '卡券核销',
      'canc': '取消',
      'QYZF': '企业付款',
      'JSZF': '公众号支付'
    };
    Polymer({
      is: 'trade-view',

      properties: {
        item: Object,
      },
      open: function() {
        this.$.dialogView.open();
      },
      _currencyFilter: function(money) {
        return (money / 100).toFixed(2);
      },
      busicdFilter: function(busicd) {
        return (busicd + '—' + TRANS_TYPE_MAP[busicd]) || busicd;
      },
      chanFilter: function(chanCode) {
        var map = {
          'ALP': '支付宝',
          'WXP': '微信'
        };
        return (chanCode + '—' + map[chanCode]);
      },
      transStatusFilter: function(status) {
        var map = {
          '10': '处理中',
          '20': '失败',
          '30': '成功',
          '40': '已关闭'
        };
        return (status + '—' + map[status]);
      },
    });
  </script>
</dom-module>
